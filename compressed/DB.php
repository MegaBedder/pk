<?php
class DB{$i='`',$p;static $q;function DB($c){$this->c=$c;}function column($q,$p=NULL,$k=0){if($s=$this->query($q,$p))return$s->fetchColumn($k);}function row($q,$p=NULL){if($s=$this->query($q,$p))return$s->fetch();}function fetch($q,$p=NULL){if($s=$this->query($q,$p))return$s->fetchAll();}function query($q,$p=NULL){$s=$this->c->prepare(self::$q[]=strtr($q,'`',$this->i));$s->execute($p);return$s;}function insert($t,$d){$x=$this;$q="INSERT INTO `$t`(`".implode('`,`',array_keys($d)).'`)VALUES('.rtrim(str_repeat('?,',count($d=array_values($d))),',').')';return$x->p?$x->column($q.'RETURNING `id`',$d):($x->query($q,$d)?$x->c->lastInsertId():NULL);}function update($t,$d,$w){$q="UPDATE `$t` SET `".implode('`=?,`',array_keys($d)).'`=? WHERE '.(is_array($w)?$this->where($w,$d):$w);if($s=$this->query($q,array_values($d)))return$s->rowCount();}function delete($t,$w){$p;if($s=$this->query("DELETE FROM `$t` WHERE ".(is_array($w)?$this->where($w,$p):$w),$p))return$s->rowCount();}function where($w,&$p){$s;foreach($w as$c=>$v){$s[]="`$c`=?";$p[]=$v;}return join(' AND ',$s);}}